version
load("~/Estadistica/R_Clases/Tutorial 2_Lectura de datos en R (versión 2023).R")
version()
version
b<- a+3
a<-1
b<- a+3
b<- -90.06   # objeto b que consiste del valor -90.06
b.<<- -90.06
x<- b       # el valor "b" es asignado a "x"
install.packages("ggplot2")
setwd("~/Estadistica/Proyecto/equipo13_Fase3")
load("~/Estadistica/Proyecto/equipo13_Fase3/.RData")
library(GGally)
library(GGally)
ggpairs(calidad_Aire_Limpio)
ggpairs(calidad_Aire_Limpio, upper = list(continuous = "smooth"),
lower = list(continuous = "blank"),
diag = list(continuous = "densityDiag"))
?ggpairs
ggpairs(calidad_Aire_Limpio, ggplot2::aes(colour=species))
ggpairs(calidad_Aire_Limpio, colour=species)
ggpairs(calidad_Aire_Limpio, colour=5)
ggpairs(calidad_Aire_Limpio, colour="red")
library(GGally)
library(ggplot2)
ggpairs(calidad_Aire_Limpio, ggplot2::aes(colour=species))
library(GGally)
library(ggplot2)
ggpairs(calidad_Aire_Limpio, ggplot2::aes(colour="blue"))
library(GGally)
ggpairs(calidad_Aire_Limpio)
install.packages("corrplot")
library(corrplot)
corrplot(cor(inteligencia))
library(corrplot)
corrplot(cor(calidad_Aire_Limpio))
?corrplot
library(GGally)
ggpairs(calidad_Aire_Limpio)
attach(calidad_Aire_Limpio)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores
model.monoxido1<- lm(Monoxido_carbono~Benceno+Oxidos_nitrogeno+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
summary(model.monoxido1)
install.packages("gvlma")
library(gvlma)
valida_model <- gvlma(model.monoxido1)
summary(valida_model)
# Graficas de diagnostico
plot(model.monoxido1)
step(object = model.monoxido1, direction = "both", trace = 1)
calidad_Aire_Limpio$transformacion_benceno <- trans.benceno
calidad_Aire_Limpio$transformacion_oxidos <- trans.oxidos
View(calidad_Aire)
View(calidad_Aire_Limpio)
attach(calidad_Aire_Limpio)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores transformados
model.monoxido1<- lm(Monoxido_carbono~transformacion_benceno+transformacion_oxidos+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
summary(model.monoxido1)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores transformados
model.monoxido2<- lm(Monoxido_carbono~transformacion_benceno+transformacion_oxidos+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
summary(model.monoxido1)
````{r}
step(object = model.monoxido2, direction = "both", trace = 1)
library(gvlma)
valida_model2 <- gvlma(model.monoxido2)
summary(valida_model2)
plot(model.monoxido1)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores transformados
model.monoxido2<- lm(Monoxido_carbono~transformacion_benceno+transformacion_oxidos+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
summary(model.monoxido2)
plot(model.monoxido2)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores
model.monoxido1<- lm(Monoxido_carbono~Benceno+Oxidos_nitrogeno+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
summary(model.monoxido1)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores
model.monoxido1<- lm(Monoxido_carbono~Benceno+Oxidos_nitrogeno+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
summary(model.monoxido1)
library(gvlma)
valida_model <- gvlma(model.monoxido1)
summary(valida_model)
plot(model.monoxido1)
step(object = model.monoxido1, direction = "both", trace = 1)
calidad_Aire_Limpio$transformacion_benceno <- trans.benceno
calidad_Aire_Limpio$transformacion_oxidos <- trans.oxidos
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores transformados
model.monoxido2<- lm(Monoxido_carbono~transformacion_benceno+transformacion_oxidos+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
summary(model.monoxido2)
# Graficas de diagnostico
plot(model.monoxido2)
library(nortest)
lillie.test(model.monoxido2$residuals)
# Criterio VIF
library(car)
vif(model.monoxido1)
library(corrplot)
corrplot(cor(calidad_Aire_Limpio))
attach(calidad_Aire_Limpio)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores transformados
model.monoxido3<- lm(Monoxido_carbono~Benceno+Dioxido_nitrogeno+Temperatura, data = calidad_Aire_Limpio)
summary(model.monoxido3)
library(gvlma)
valida_model <- gvlma(model.monoxido3)
summary(valida_model)
# Graficas de diagnostico
plot(model.monoxido2)
attach(calidad_Aire_Limpio)
# Modelo con todos los predictores transformados
model.monoxido3<- lm(Monoxido_carbono~transformacion_benceno+Dioxido_nitrogeno+Temperatura, data = calidad_Aire_Limpio)
summary(model.monoxido3)
library(gvlma)
valida_model <- gvlma(model.monoxido3)
summary(valida_model)
boxplot.matrix(as.matrix(calidad_Aire_Limpio),use.cols = T)
install.packages("olsrr")
library(olsrr)
ols_plot_cooksd_chart(model.monoxido1)
# DFBETA mide la diferencia en la estimacion de cada parametro con y sin el punto influyente.
# Hay un valor de DFBETA para cada observacion, es decir, hay n observaciones y k parametros, por lo que hay n*k DFBETAs.
# En general, valores grandes de DFBETAS indican observaciones que son influyentes en la estimacion de cierto parametro.
ols_plot_dfbetas(model.monoxido1)
ols_plot_resid_stud(model.monoxido1)
library(car)
outlierTest(model.inteligencia2)
library(car)
outlierTest(model.monoxido1)
?row.names
row.names(calidad_Aire_Limpio[1,])
row.names(calidad_Aire_Limpio[2,])
View(calidad_Aire_Limpio)
row.names(calidad_Aire_Limpio[1])
View(calidad_Aire_Limpio)
?row
calidad_Aire_Limpio[1,]
calidad_Aire_Limpio[1,]
(calidad_Aire_Limpio[1,])
View(calidad_Aire_Limpio)
row.names(calidad_Aire_Limpio[1,])
registro_seis <- calidad_Aire_Limpio[6, ]
View(registro_seis)
registros_a_eliminar <- c(4259, 4258, 5817, 4918, 4204, 5418, 4260, 5417, 5406, 5407)
datos_sin_registros <- calidad_Aire_Limpio[-registros_a_eliminar, ]
model.monoxido4<- lm(Monoxido_carbono~Benceno+Oxidos_nitrogeno+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = datos_sin_registros)
summary(model.monoxido4)
plot(model.monoxido4)
seq(2,6)
View(calidad_Aire_Limpio)
max(Humedad_relativa)
nuevos_datos <- data.frame(
var1 = c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1
var2 = c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
var3 = c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
)
a<- max(Benceno)+5
max(Benceno)
attach(calidad_Aire_Limpio)
nuevos_datos <- data.frame(
var1 = c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1
var2 = c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
var3 = c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
)
max(Benceno)+5
max(Oxidos_nitrogeno)
nuevos_datos <- data.frame(
var1 = c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1
var2 = c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
var3 = c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
)
nuevos_datos <- data.frame(
var1 = c(5,
20,
20,
3,
2),  # Valores para var1
var2 = c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
var3 = c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
)
nuevos_datos <- data.frame(
var1 = c(5,
20,
20,
3,
2),  # Valores para var1
var2 = c(10,
40,
40,
5,
4),  # Valores para var2
var3 = c(15,
50,
50,
7,
6),  # Valores para var3
)
nuevos_datos <- data.frame(
var1 = c(5,
20,
20,
3,
2),  # Valores para var1
var2 = c(10,
40,
40,
5,
4),  # Valores para var2
var3 = c(15,
50,
50,
7,
6),  # Valores para var3
stringsAsFactors = FALSE
)
nuevos_datos <- data.frame(
var1 = c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1
var2 = c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
var3 = c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
stringsAsFactors = FALSE
)
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
nuevos_datos <- data.frame(
c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1
c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
)
nuevos_datos <- data.frame(5,10,20,30,40)
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
nuevos_datos <- data.frame(c(5,10,20,30,40))
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
?predict
nuevos_datos <- data.frame(1)
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
nuevos_datos <- data.frame(1)
predicciones <- predict(model.monoxido1, nuevos_datos)
head(predicciones)
nuevos_datos <- data.frame((12,3,5,1,8)
nuevos_datos <- data.frame(c(12,3,5,1,8)
predicciones <- predict(model.monoxido1, nuevos_datos)
nuevos_datos <- data.frame(c(12,3,5,1,8))
predicciones <- predict(model.monoxido1, nuevos_datos)
head(predicciones)
View(model.monoxido1)
nuevos_datos <- data.frame(X=seq(2,6))
predicciones <- predict(model.monoxido1, nuevos_datos)
head(predicciones)
nuevos_datos <- data.frame(X=seq(2,6), X=seq(3,7))
predicciones <- predict(model.monoxido1, nuevos_datos)
head(predicciones)
attach(calidad_Aire_Limpio)
nuevos_datos <- data.frame(X=seq(2,6), Y=seq(3,7))
predicciones <- predict(model.monoxido1, nuevos_datos)
head(predicciones)
attach(calidad_Aire_Limpio)
nuevos_datos <- data.frame(
var1 = c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1
var2 = c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
var3 = c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
stringsAsFactors = FALSE
)
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
nuevos_datos <- data.frame(
var1 = c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1 # Valores para var3
stringsAsFactors = FALSE
)
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
nuevos_datos <- data.frame(
(max(Benceno)+5,
nuevos_datos <- data.frame(
(max(Benceno)+5,
nuevos_datos <- data.frame(
c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2)  # Valores para var1 # Valores para var3
)
View(model.monoxido3)
View(nuevos_datos)
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
predicciones <- predict(model.monoxido1, nuevos_datos)
head(predicciones)
predicciones
View(model.monoxido1)
model.monoxido1<- lm(Monoxido_carbono~Benceno+Oxidos_nitrogeno+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
attach(calidad_Aire_Limpio)
nuevos_datos <- data.frame(
c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2)  # Valores para var1 # Valores para var3
)
predicciones <- predict(model.monoxido1, nuevos_datos)
predicciones
nuevos_datos <- data.frame(
var1 = c(max(Benceno)+5,
max(Oxidos_nitrogeno)+20,
max(Dioxido_nitrogeno)+20,
max(Temperatura)+3,
max(Humedad_relativa)+2),  # Valores para var1
var2 = c(max(Benceno)+10,
max(Oxidos_nitrogeno)+40,
max(Dioxido_nitrogeno)+40,
max(Temperatura)+5,
max(Humedad_relativa)+4),  # Valores para var2
var3 = c(max(Benceno)+15,
max(Oxidos_nitrogeno)+50,
max(Dioxido_nitrogeno)+50,
max(Temperatura)+7,
max(Humedad_relativa)+6),  # Valores para var3
stringsAsFactors = FALSE
)
predicciones <- predict(model.monoxido1, nuevos_datos, interval="prediction")
head(predicciones)
model.monoxido20<- lm(Monoxido_carbono~Benceno+Oxidos_nitrogeno+Dioxido_nitrogeno+Temperatura+Humedad_relativa, data = calidad_Aire_Limpio)
View(model.monoxido20)
summary(model.monoxido20)
X1<- data.frame(X=seq(1,5))
ic.fitHubble2 <- predict(model.monoxido20,X1,interval="confidence")
head(ic.fitHubble2)
X1<- data.frame(1)  # debemos cambiar el formato de los datos
ic.fitHubble2 <- predict(model.monoxido20,X1,interval="confidence")
head(ic.fitHubble2)
library(readxl)
datos_sucios<- read_excel("AirQualityUCI.xlsx")
library(dplyr)
datos_sucios<- rename(datos_sucios,
Fecha = "Date",
Hora = "Time",
Monoxido_carbono = "CO(GT)",
Oxido_estaño = "PT08.S1(CO)",
Hidrocarburos_no_metanicos = "NMHC(GT)",
Benceno = "C6H6(GT)",
Titanio = "PT08.S2(NMHC)",
Oxidos_nitrogeno = "NOx(GT)",
Oxido_tungsteno = "PT08.S3(NOx)",
Dioxido_nitrogeno = "NO2(GT)",
Oxido_tungsteno_NO2 = "PT08.S4(NO2)",
Oxido_indio = "PT08.S5(O3)",
Temperatura = "T",
Humedad_relativa  = "RH",
Humedad_absoluta = "AH")
names(datos_sucios)
# Resumen rapido, conociendo los tipos de datos
skimr::skim(datos_sucios)
install.packages("stringi")
